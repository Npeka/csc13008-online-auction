enum OrderStatus {
  PENDING_PAYMENT
  PAYMENT_SUBMITTED
  PAYMENT_CONFIRMED
  SHIPPED
  DELIVERED
  COMPLETED
  CANCELLED
}

// Order/Transaction management after auction ends
model Order {
  id         String      @id @default(cuid())
  finalPrice Float
  status     OrderStatus @default(PENDING_PAYMENT)

  // Payment & Shipping information
  paymentProof      String? // Payment proof URL or reference
  shippingAddress   String?
  trackingNumber    String? // Shipping tracking number
  cancellationReason String? // Reason if cancelled

  // Relations
  productId String  @unique
  product   Product @relation(fields: [productId], references: [id])
  buyerId   String
  buyer     User    @relation("OrderBuyer", fields: [buyerId], references: [id])
  sellerId  String
  seller    User    @relation("OrderSeller", fields: [sellerId], references: [id])

  // Chat and ratings
  messages ChatMessage[]
  ratings  Rating[]

  // Timestamps
  createdAt   DateTime  @default(now())
  paidAt      DateTime?
  shippedAt   DateTime?
  deliveredAt DateTime?
  completedAt DateTime?
  cancelledAt DateTime? // When order was cancelled
  updatedAt   DateTime  @updatedAt

  @@index([buyerId, status])
  @@index([sellerId, status])
  @@index([status, createdAt])
  @@map("orders")
}
